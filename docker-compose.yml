version: "2"

services:
 glassfish:
   build: ./server
   #image: glassfish3:v4
   ports:
     - "8080:8080"
     - "4848:4848"
     - "222:22"
    # - "9999-15000:9999-15000"
   #volumes:
   #  - /opt/dockerVol/glassfish/autodeploy:/usr/local/glassfish3/glassfish/domains/domain1/autodeploy

#apache:
#    #build : ./repo
#     image: trinitronx/python-simplehttpserver
#     ports: 
#      - '9091:8080'
#     volumes:
#      - '/home/ingsoluciones/builder-TesterComposeDocker/repo/installers:/var/www:ro' 



 nexus:
   #build: ./repoDepend
   image: sonatype/nexus
   ports:
     - "6091:8081"
   volumes:
     - /opt/dockerVol/nexusData:/sonatype-work

 jenkins:
    build: ./builder
    #image: 'jenk-mvn-git-nex:v1'
    environment:
      JAVA_OPTS: "-Djava.awt.headless=true"
    links:
      - nexus 
    ports:
      - "50000:50000"
      - "6090:8080"
    volumes:
      - /opt/dockerVol/jenkinsData/jobs:/var/jenkins_home/jobs
      #- /opt/dockerVol/glassfish/Autodeploy:/opt/dockerVol/glassfish/deploy

 selenium_hub:
    image: selenium/hub
    container_name: selenium_hub
    privileged: true
    ports:
      - 4444:4444
    environment:
      - GRID_TIMEOUT=120000
      - GRID_BROWSER_TIMEOUT=120000
    networks:
        - selenium_grid_internal

 nodechrome:
    image: selenium/node-chrome-debug
    privileged: true
    depends_on:
      - selenium_hub
    ports:
      - 5900
    environment:
      - no_proxy=localhost
      - TZ=Europe/London
      - HUB_PORT_4444_TCP_ADDR=selenium_hub
      - HUB_PORT_4444_TCP_PORT=4444
    networks:
      - selenium_grid_internal

 nodefirefox:
    image: selenium/node-firefox-debug
    privileged: true
    depends_on:
       - selenium_hub
    ports:
       - 5900
    environment:
       - no_proxy=localhost
       - TZ=Europe/London
       - HUB_PORT_4444_TCP_ADDR=selenium_hub
       - HUB_PORT_4444_TCP_PORT=4444
    networks:
       - selenium_grid_internal
networks:
    selenium_grid_internal:
      
